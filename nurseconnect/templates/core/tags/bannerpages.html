{% load wagtailcore_tags wagtailimages_tags static %}
{% if bannerpages %}
    <section class="Paper">
        <article class="Paper-body">
            {% for bannerpage in bannerpages %}
              {% if bannerpage.banner %}
                <script type="text/javascript">
                'use strict';
                  (function() {
                    //GET COOKIE
                    function getCookie(cname) {
                      var name = cname + "=",
                          ca = document.cookie.split(';'),i,c,
                          ca_length = ca.length;
                      for (i = 0; i < ca_length; i += 1) {
                          c = ca[i];
                          while (c.charAt(0) === ' ') {
                              c = c.substring(1);
                          }
                          if (c.indexOf(name) !== -1) {
                              return c.substring(name.length, c.length);
                          }
                      }
                      return "";
                      }
                      //SET COOKIE
                      function setCookie(name, value, days) {
                        var expires;
                        if(days) {
                          var date = new Date();
                          date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                          expires = "; expires=" + date.toGMTString();
                        } else {expires = "";}
                        document.cookie = name + "=" + value + expires + "; path=/";
                      }
                      setCookie("banner_version", 1, 30);

                    //DELETE COOKIE
                    function delete_cookie(name) {
                      document.cookie = name + '=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
                    }

                    if (performance.navigation.type == 1 && window.location.pathname == "/") {
                      delete_cookie("banner_version");
                      setCookie("banner_version", 2, 30);
                    }
                    var readCookieByValue = getCookie("banner_version");
                      if(readCookieByValue == 1) {
                        var imagePath = "{% spaceless %}{{banner_image}}{% endspaceless %}";
                      } else {
                        var imagePath = "{% spaceless %}{{banner_image_secondary}}{% endspaceless %}";
                      }
                  })();
                  </script>
                    <header class="Paper-header">
                        <h1 class="Paper-headline">{{ bannerpage.title }}</h1>
                        {% if bannerpage.banner_link_page %}
                          <a href="{% pageurl bannerpage.banner_link_page %}">
                            {% image bannerpage.banner width-320 as imagePath %}
                            <img src="{{imagePath.url}}" class="Paper-graphic">
                          </a>
                        {% else %}
                          {% image bannerpage.banner width-320 as imagePath %}
                          <img src="{{imagePath.url}}" class="Paper-graphic">
                        {% endif %}
                    </header>
                {% endif %}
            {% endfor %}
        </article>
    </section>
{% endif %}
