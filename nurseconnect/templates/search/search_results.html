{% load wagtailcore_tags wagtailimages_tags i18n %}

{% block content %}
    {% for page in search_results %}
        {% with parent_section=page.get_parent_section ancestor=page.get_parent_section.get_ancestors.last %}
            <article class="ContentList ContentList--bgTertiary">
                {% if ancestor.sectionpage.image %}
                    <a href="{% pageurl page %}">
                        <header class="ContentList-header">
                            <h2 class="ContentList-categoryLabel">{{ ancestor.title }}</h2>
                        </header>
                        <h3 class="ListItem-title">{{ page.title }}</h3>
                        <p>{{ page.subtitle }}</p>
                    </a>
                {% else %}
                    <a href="{% pageurl page %}">
                        <header class="ContentList-header">
                            <h2 class="ContentList-categoryLabel">{{ parent_section.title }}</h2>
                        </header>
                        <h3 class="ListItem-title">{{ page.title }}</h3>
                        <p>{{ page.subtitle }}</p>
                    </a>
                {% endif %}
            </article>
        {% endwith %}
    {% endfor %}

    <div class="step-links">
        {% if search_results.has_previous %}
            <a href="?p={{ search_results.previous_page_number }}&amp;q={{ search_query }}">&larr;</a>
        {% endif %}
        <span class="current">
            Page {{ search_results.number }} of {{ search_results.paginator.num_pages }}
        </span>
        {% if search_results.has_next %}
            <a href="?p={{ search_results.next_page_number }}&amp;q={{ search_query }}">&rarr;</a>
        {% endif %}
    </div>
{% endblock %}

